<!DOCTYPE html>
<html lang="en-us" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="UTF-8">
    <meta name="description" content="도메인 서비스 : 도메인 모델 내 무상태 오퍼레이션 제공 애그리게잇이나 값 객체의 행위로써 어울리지 않는 것 before class Product { Set backlogItems ; BusinessPriorityTotals businessPriorityTotals () { //... } } 모델 정제를 통해 Set backlogItems 를 분리 그렇다면 businessPriorityTotals() 메서드는...">
    <meta name="generator" content="Movable Type 6.3.6">
    <title>IDDD 7ì¥. ìë¹ì¤ - redutan</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="http://weblog.youre.space/redutan/styles.css">
    <!--[if lt IE 9]>
    <link rel="stylesheet" href="http://weblog.youre.space/redutan/styles_ie.css">
    <script src="http://connexus.youre.space/mt-static/support/theme_static/rainier/js/html5shiv.js"></script>
    <![endif]-->
    
    <link rel="start" href="http://weblog.youre.space/redutan/">
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="http://weblog.youre.space/redutan/atom.xml" />
    <link rel="canonical" href="http://weblog.youre.space/redutan/2018/07/001045.html" />
    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-102177098-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


    <link rel="prev" href="http://weblog.youre.space/redutan/2018/07/001043.html" title="IDDD 6장. 값 객체">
    
    <!-- Open Graph Protocol -->
    <meta property="og:type" content="article">
    <meta property="og:locale" content="en-us">
    <meta property="og:title" content="IDDD 7ì¥. ìë¹ì¤">
    <meta property="og:url" content="http://weblog.youre.space/redutan/2018/07/001045.html">
    <meta property="og:description" content="도메인 서비스 : 도메인 모델 내 무상태 오퍼레이션 제공 애그리게잇이나 값 객체의 행위로써 어울리지 않는 것 before class Product { Set backlogItems ; BusinessPriorityTotals businessPriorityTotals () { //... } } 모델 정제를 통해 Set backlogItems 를 분리 그렇다면 businessPriorityTotals() 메서드는...">
    <meta property="og:site_name" content="redutan">
    <meta property="og:image" content="http://connexus.youre.space/mt-static/support/theme_static/rainier/img/siteicon-sample.png">
    <!-- Metadata -->
    <meta itemprop="description" content="도메인 서비스 : 도메인 모델 내 무상태 오퍼레이션 제공 애그리게잇이나 값 객체의 행위로써 어울리지 않는 것 before class Product { Set backlogItems ; BusinessPriorityTotals businessPriorityTotals () { //... } } 모델 정제를 통해 Set backlogItems 를 분리 그렇다면 businessPriorityTotals() 메서드는...">
    <link itemprop="url" href="http://weblog.youre.space/redutan/2018/07/001045.html">
    <link itemprop="image" href="http://connexus.youre.space/mt-static/support/theme_static/rainier/img/siteicon-sample.png">
    
  </head>
  <body>
    <div id="container">
      <div id="container-inner">
        <header id="header" role="banner">
          <div id="header-inner">
            <div id="header-content">
              <h1>
                <a href="http://weblog.youre.space/redutan/">

                  redutan

                </a>
              </h1>
              
            </div>

            <nav role="navigation">
          <ul>
            <li><a href="http://weblog.youre.space/redutan/">Home</a></li>


          </ul>
        </nav>

          </div>
        </header>
        <div id="content">
          <div id="content-inner">
            <ul class="breadcrumb breadcrumb-list">
              <li class="breadcrumb-list-item"><a href="http://weblog.youre.space/redutan/">Home</a></li>
              <li class="breadcrumb-list-item">IDDD 7ì¥. ìë¹ì¤</li>
            </ul>
            <div id="individual-main" class="main" role="main">
              <article id="entry-1045" class="entry entry-asset asset hentry">
                <div class="asset-header">
                  <h2 itemprop="name" class="asset-name entry-title">IDDD 7ì¥. ìë¹ì¤</h2>
                  <footer class="asset-meta">
                    <ul class="asset-meta-list">
                      <li class="asset-meta-list-item">Posted on <time datetime="2018-07-13T07:26:48+09:00" itemprop="datePublished">July 13, 2018</time></li>
                      <li class="asset-meta-list-item">by <span class="author entry-author vcard"><a class="fn url" href="http://weblog.youre.space/vergence/">Sangyong Gwak</a></span></li>

  

                   </ul>
                </footer>
                </div>
                <div class="entry-content asset-content" itemprop="articleBody">
                  도메인 서비스 : 도메인 모델 내 무상태 오퍼레이션 제공

애그리게잇이나 값 객체의 행위로써 어울리지 않는 것

before

class Product {

Set  backlogItems ;

BusinessPriorityTotals businessPriorityTotals () {

//...

}

}

모델 정제를 통해 Set backlogItems 를 분리

그렇다면 businessPriorityTotals() 메서드는 어떻게 되는가?

after

class Product {

static BusinessPriorityTotals businessPriorityTotals (

Set  aBacklogItems ) {

// ...

}

}

정적 메소드로 변경 - 하지만 과연 이것은 옳은가?

도메인 서비스 가 필요한 시점이다!

도메인 서비스란 무엇인가

하지만 그보다 먼저 도메인 서비스가 아닌 것은 무엇인가?

도메인 서비스 : 도메인 로직이 있다.

애플리케이션 서비스 : 도메인 로직이 없다. (보안, 트랜잭션 등)

정의

엔터티나 값객체의 책임이 아닌 (도메인적) 행위

유비쿼터스 언어로써 표현

무상태!

예시

중요 비즈니스 프로세스

복수 개 의 도메인 객체에서 필요로 하는 계산

한 조합에서 다른 조합으로 도메인 객체를 변형 할 때

서비스가 필요할지 확인하자

도메인 특화 지식은 클라이언트로 절대 유촐돼선 안된다.(클라이언트가 애플리케이션 서비스일지라도)

도메인 객체에 위치 시키기 애매하면 도메인 서비스 에 담는다.

주의 : 도메인 서비스를 남용하면 빈약한(Anemic) 도메인 모델이 된다.

도메인에서 서비스를 모델링하기

AuthenticationService

package com . saasovation . identityaccess . domain . model . identity ; // !!

interface AuthenticationService {

UserDescriptor authenticate (

TenantId tenantId ,

String username ,

Strin password );

}

EncryptionAuthenticationService

package com . saasovation . identityaccess . infra . services ; // !!

class EncryptionAuthenticationService implements AuthenticationService {

@Override

UserDescriptor authenticate (

@NonNull TenantId tenantId ,

@NonNull String username ,

@NonNull Strin password ) {

Tenant tenant = tenantRepository . findById ( tenantId );

if ( tenant == null || ! tenant . isActive ()) {

throw new TenantNotFoundException ( tenantId );

}

String encryptedPassword =

encryptService . encryptedValue ( passwod ); // 암호화 책임도 도메인 서비스?

User user = userRepository . findByTenantAndUsernameAndPassword (

tenant , username , encryptedPassword );

if ( user == null || ! user . isEnabled ()) {

throw new UserNotFoundException ( username );

}

return user . userDescriptor ();

}

}

분리된 인터페이스가 꼭 필요할까

다형성이 요구되지 않는다면 굳이 분리된 인터페이스는 필요하지 않다고 본다.

다형성 등으로 인한 추상화가 요구될 때 분리된 인터페이스로 리팩토링 하자

생각 : 구현클래스에 Impl 접미사를 붙이는 것은 가능하면 피하는 것이 좋다고 본다.

DI 프레임워크(ex:Spring)를 사용하면 분리된 인터페이스를 사용하기 더 편하다.

계산 프로세스

생각 : 계산(연산)은 변하지 않는 행동이므로 분리된 인터페이스 는 필요하지 않다.

대부분 경우 계산 프로세스를 정적 메서드 로 해결하는 경향이 많다.

이는 잘못된 행동이며 계산이 도메인 로직을 표현한다면 당연히 도메인 모델 내에 도메인 서비스로써 존재 해야 한다.

참고 : p.369 ~ 371 소스코드

변환 서비스

타 서비스와 통합을 위해 사용

이것도 도메인 서비스 였다니

Adapter

package com . saasovation . collaboration . infra . services ;

class UserInRoleAdapter {

 T toCollaborator (

Tenant tenant , String identity , String role ,

Class  collaboratorClass );

}

Translator

package com . sasovation . collaboration . infra . services ;

class CollbaratorTransaltor {

 T toCollaboratorFrom (

String json , Class  collaboratorClass );

}

생각 : translator도 도메인 서비스 인가?

도메인 서비스의 미니 계층 사용하기

가능하면 미니 계층은 사용하지 말자 - 안티패턴!

하지만 필요하다면 특정 도메인만 제한적으로 사용하는 것도 좋다.

마무리

도메인 서비스는 필요할 때 사용

남용하면 빈약한 도메인 모델화

무상태

VS 애플리케이션 서비스

IDDD 7장. 서비스 was originally published by MJ at DevOOOOOOOOP on May 18, 2018.

source : http://redutan.github.io/2018/05/18/IDDD-chapter07<br />---------------------------------------------------------------------------<br />Visit this link to stop these emails: http://zpr.io/nXidW

                  
                </div>
                <nav class="page-navigation entry-navigation pagination content-nav">
                  <ul class="page-navigation-list">

                    <li class="page-navigation-list-item page-navigation-prev"><a rel="prev" href="http://weblog.youre.space/redutan/2018/07/001043.html" title="IDDD 6장. 값 객체">Previous entry</a></li>


                  </ul>
                </nav>
                <!--
<aside id="zenback" class="zenback feedback">
  
    Please paste Zenback script code here.
  
</aside>
-->
                
                <aside id="trackbacks" class="trackbacks feedback">
  <h2>TrackBacks</h2>
  
  <p id="trackback-url">TrackBack URL: http://connexus-recall.youre.space:5000/mt-tb.cgi/321</p>
  
  
</aside>


              </article>
            </div>
            <aside class="widgets related" role="complementary">
              <nav class="widget-search widget">
  <div class="widget-content">
    <form method="get" id="search" action="http://connexus-recall.youre.space:5000/mt-search.cgi">
      <div>
        <input type="text" name="search" value="" placeholder="Search...">

        <input type="hidden" name="IncludeBlogs" value="17">

        <input type="hidden" name="limit" value="20">
        <button type="submit" name="button">
          <img alt="Search" src="http://connexus.youre.space/mt-static/support/theme_static/rainier/img/search-icon.png">
        </button>
      </div>
    </form>
  </div>
</nav>
<nav class="widget-archive-dropdown widget">
  <h3 class="widget-header">Archives</h3>
  <div class="widget-content">
    <select>
      <option>Select a Month...</option>
    
      <option value="http://weblog.youre.space/redutan/2018/07/">July 2018</option>
    
  
    
      <option value="http://weblog.youre.space/redutan/2018/06/">June 2018</option>
    
  
    
      <option value="http://weblog.youre.space/redutan/2018/05/">May 2018</option>
    
  
    
      <option value="http://weblog.youre.space/redutan/2018/04/">April 2018</option>
    
  
    
      <option value="http://weblog.youre.space/redutan/2018/02/">February 2018</option>
    
    </select>
  </div>
</nav>
    
  

<div class="widget-syndication widget section">
  <div class="widget-content">
    <p><img src="http://connexus.youre.space/mt-static/images/status_icons/feed.gif" alt="Subscribe to feed" width="9" height="9" /> <a href="http://weblog.youre.space/redutan/atom.xml">Subscribe to this blog's feed</a></p>

  </div>
</div>

            </aside>
          </div>
        </div>
        <footer id="footer" role="contentinfo">
          <div id="footer-inner">
            <div id="footer-content">
  <nav role="navigation">
          <ul>
            <li><a href="http://weblog.youre.space/redutan/">Home</a></li>


          </ul>
        </nav>

  <p class="license">&copy; Copyright 2018.</p>
  <p class="poweredby">Powered by <a href="http://www.movabletype.org/">Movable Type</a></p>
</div>
          </div>
        </footer>
      </div>
    </div>
    <script src="http://connexus.youre.space/mt-static/jquery/jquery.min.js"></script>
    <script src="http://weblog.youre.space/redutan/mt-theme-scale2.js"></script>
  </body>
</html>
